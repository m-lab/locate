dist: jammy

language: go
go:
- go1.20.14

addons:
  apt:
    update: true
    packages:
    - ca-certificates

#before_install:
#- echo "${TRAVIS_GO_VERSION}"
  #- echo "${TRAVIS_GO_IMPORT_PATH}"
  #- rm -f /home/travis/gopath/bin/go # remove existing symbolic link.
  #- travis_setup_go 1.20.14

install:
- go1.20.14 install -v ./...
- go1.20.14 install github.com/mattn/goveralls@latest

script:
- go1.20.14 vet ./...
- go1.20.14 test -timeout 5m -v -p 1 ./... -cover=1 -coverprofile=_c.cov
- go1.20.14 test -timeout 5m -v ./... -race

after_success:
# Note: Do this in the after_success stage so that
# a broken coveralls won't cause the build to fail.
# (details: https://github.com/lemurheavy/coveralls-public/issues/1264)
- $GOPATH/bin/goveralls -service=travis-pro -coverprofile=_c.cov
